{% set products = __SELF__.products %}

<section class="product-slider section" data-js="home-products-slider-body">
  <div class="product-slider__wrap wrap">
    <div class="product-slider__heading">
      <h2 class="product-slider__title">{{ __SELF__.title }}</h2>
      <div class="product-slider__controls">
        <button class="product-slider__controls-btn product-slider__controls-btn--prev" data-js-action="home-products-control">
          <svg class="product-slider__controls-ico icon-arrow-prev">
            <use xlink:href="{{ 'assets/spritemap.svg#sprite-arrow-prev'|theme }}"></use>
          </svg>
        </button>
        <button class="product-slider__controls-btn product-slider__controls-btn--next" data-js-action="home-products-control">
          <svg class="product-slider__controls-ico icon-arrow-next">
            <use xlink:href="{{ 'assets/spritemap.svg#sprite-arrow-next'|theme }}"></use>
          </svg>
        </button>
      </div>
    </div>
    <div class="product-slider__main">
      <div class="product-slider__swiper swiper" data-js-slider="home-products">
        <div class="swiper-wrapper">
          {% for product in products %}
          <div class="product-slider__item swiper-slide">
            <div class="product-item" data-product-index="{{ product.id }}">
              <div class="product-item__top">
                <div class="product-item__tags">
                  {% if product.is_new %}
                  <div class="product-item__tag product-item__tag--new">New</div>
                  {% endif %}
                  {% if product.is_hit %}
                  <div class="product-item__tag product-item__tag--hit">Хит</div>
                  {% endif %}
                  {% if product.sale_price > 0 %}
                  <div class="product-item__tag product-item__tag--sale">
                    -{{ (100 - (product.sale_price / product.price * 100))|number_format(0, '', '') }}%
                  </div>
                  {% endif %}
                </div>
                <div class="product-item__image">
                  <a href="{{ 'product'|page({ id: product.id }) }}" class="product-item__link">
                    <picture>
                      <source srcset="{{ product.image|media|resize(281, 281, { mode: 'crop', quality: '80' }) }}">
                      <img src="{{ product.image|media|resize(281, 281, { mode: 'crop', quality: '80' }) }}" alt="{{ product.title }}" class="product-item__image-thumb" />
                    </picture>
                  </a>
                </div>
              </div>
              <div class="product-item__bottom">
                <div class="product-item__info">
                  <a href="{{ 'product'|page({ id: product.id }) }}" class="product-item__title">{{ product.title }}</a>
                  <div class="product-item__price">
                    {% if product.sale_price > 0 %}
                      <div class="product-item__current-price">
                        <strong class="product-item__price-val" data-price>{{ product.sale_price|number_format(2, '.', ' ') }}</strong>
                        <span class="product-item__price-label">₽</span>
                      </div>
                      <div class="product-item__old-price">
                        <strong class="product-item__price-val" data-price>{{ product.price|number_format(2, '.', ' ') }}</strong>
                        <span class="product-item__price-label">₽</span>
                      </div>
                    {% else %}
                      <div class="product-item__current-price">
                        <strong class="product-item__price-val" data-price>{{ product.price|number_format(2, '.', ' ') }}</strong>
                        <span class="product-item__price-label">₽</span>
                      </div>
                    {% endif %}
                  </div>
                </div>

                <div class="product-item__cart">
                  <div class="product-item__amount">
                    <div class="product-amount" data-js-action="update-qty">
                      <button type="button" class="product-amount__btn js-remove-cart">
                        <svg class="product-amount__btn-ico icon-minus">
                          <use xlink:href="{{ 'assets/spritemap.svg#sprite-minus'|theme }}"></use>
                        </svg>
                      </button>
                      <input
                        type="number"
                        readonly="readonly"
                        class="product-amount__val"
                        value="1"
                        data-js-action="qty-val"
                      />
                      <button type="button" class="product-amount__btn js-add-cart">
                        <svg class="product-amount__btn-ico icon-plus">
                          <use xlink:href="{{ 'assets/spritemap.svg#sprite-plus'|theme }}"></use>
                        </svg>
                      </button>
                    </div>
                  </div>
                  <button
                    type="button"
                    class="product-item__order-btn"
                    data-product-id="{{ product.id }}"
                    data-js-action="add-to-cart"
                    data-product-amount="1"
                  >
                    <svg class="product-item__order-ico icon-shopping-cart">
                      <use xlink:href="{{ 'assets/spritemap.svg#sprite-shopping-cart'|theme }}"></use>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</section>
