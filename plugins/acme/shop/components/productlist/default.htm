{% set index = 1 %}
<div class="breadcrumbs section">
  <div class="breadcrumbs__wrap wrap" itemscope itemtype="https://schema.org/BreadcrumbList">
    {% for breadcrumb in breadcrumbs %}
    {% if not loop.last %}
    <div class="breadcrumbs__item" itemscope itemtype="https://schema.org/BreadcrumbList">
      <a itemprop="item" class="breadcrumbs__link" href="{{ breadcrumb.category ? 'category'|page({slug: breadcrumb.url}) : breadcrumb.url|page }}">
        <span itemprop="name">{{ breadcrumb.title }}</span>
      </a>
      <div class="breadcrumbs__hidden" itemprop="url" href="{{ breadcrumb.category ? 'category'|page({slug: breadcrumb.url}) : breadcrumb.url|page }}"></div>
      <meta itemprop="position" content="{{ index }}" />
      <svg class="breadcrumbs__arrow">
        <use xlink:href="{{ 'assets/spritemap.svg#sprite-breadcrumbs'|theme }}"></use>
      </svg>
    </div>
    {% else %}
    <div class="breadcrumbs__item" itemscope itemtype="https://schema.org/BreadcrumbList" >
      <div itemprop="name" class="breadcrumbs__link">{{ category.title }}</div>
      <div class="breadcrumbs__hidden" itemprop="item" itemprop="url" href="{{ 'product'|page({ slug: category.slug }) }}"></div>
      <meta itemprop="position" content="{{ index }}" />
    </div>
    {% endif %}
    {% set index = loop.index + 1 %}
    {% endfor %}
  </div>
</div>
<section class="category section" id="categorySection">
  <div class="category__wrap wrap">

    <div class="category__heading">
      <h1 class="category__title">
        {{ category.title }}
        {% if category.products_count > 0 %}
        <sup class="category__total">{{ category.products_count }} {{ countLabel }}</sup>
        {% endif %}
      </h1>
    </div>

    <div class="filters">
      <div class="filters__sorting">
        <div class="filters__sorting-body" data-js="sort-products">
          <div class="filters__sorting-result">
            <div class="filters__sorting-text" data-js-action="open-sort">{{ sort.val }}</div>
            <svg class="filters__sorting-arrow icon-filter-arrow">
              <use xlink:href="{{ 'assets/spritemap.svg#sprite-filter-arrow'|theme }}"></use>
            </svg>
          </div>
          <div class="filters__sorting-dropdown" id="partialSort">
            <div class="filters__sorting-item{{ sort.key == 'price asc' ? ' active' : '' }}" data-js-action="sort-products" data-value="price asc">Возрастание цены</div>
            <div class="filters__sorting-item{{ sort.key == 'price desc' ? ' active' : '' }}" data-js-action="sort-products" data-value="price desc">Убывание цены</div>
            <div class="filters__sorting-item{{ sort.key == 'sort_order desc' ? ' active' : '' }}" data-js-action="sort-products" data-value="sort_order desc">Вначале новые</div>
            <div class="filters__sorting-item{{ sort.key == 'sort_order asc' ? ' active' : '' }}" data-js-action="sort-products" data-value="sort_order asc">Вначале старые</div>
          </div>
        </div>
      </div>
    </div>
    <div class="category__container">
      <div class="category__row" id="partialProducts">
        {% partial "ProductList::list" %}
      </div>
      <div class="category__pagination">
        <div class="category__pagination-list" id="partialPaginate">
          {% partial "ProductList::pagination" %}
        </div>
      </div>
    </div>
  </div>
</section>
